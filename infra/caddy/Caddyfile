donfra.dev www.donfra.dev {
    handle /api/* {
        reverse_proxy http://api:8080
    }

    handle /ws/* {
        reverse_proxy http://ws:6789
    }

    handle /yjs* {
        reverse_proxy http://ws:6789
    }

    # LiveKit WebSocket and HTTP traffic
    handle /livekit/* {
        uri strip_prefix /livekit
        reverse_proxy http://livekit:7880 {
            header_up Host {upstream_hostport}
            header_up X-Forwarded-Proto {scheme}
        }
    }

    # Jaeger UI (consider adding basic auth for production)
    handle /jaeger/* {
        uri strip_prefix /jaeger
        reverse_proxy http://jaeger:16686
    }

    reverse_proxy http://ui:3000
}

library.donfra.dev {
    redir https://donfra.dev/library{uri} permanent
}

coding.donfra.dev {
    redir https://donfra.dev/coding{uri} permanent
}
